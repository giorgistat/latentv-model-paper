### A flexible class of latent variable models for the analysis of antibody response data  
### by Emanuele Giorgi and Jonas Wallin

This repository contains simulation code, model-fitting scripts, and example outputs accompanying the paper:

**Giorgi, E. and Wallin, J.**  
“A flexible class of latent variable models for the analysis of antibody response data.”  
Department of Applied Health Science, University of Birmingham  
Department of Statistics, Lund University

---

## Repository contents

### Data generation

- **00_sim_data.R**  
  Script that generates a fully synthetic dataset under the latent sero-reactivity model described in the paper.  
  Produces **sim_data.csv**, containing age, AMA1 and MSP1 values simulated from the fitted parameters.

- **sim_data.csv**  
  Synthetic data generated by the script above (no real participant data).

### Antigen-specific model fitting

- **01_ama1_analysis.R**  
  Full-likelihood fit of the latent-variable model to the AMA1 synthetic dataset.  
  Produces the AMA1 MLE and diagnostic outputs.

- **02_msp1_analysis.R**  
  Full-likelihood fit of the latent-variable model to the MSP1 synthetic dataset, using the same modelling structure.

### Model outputs

- **ama_fit.rds**  
- **msp_fit.rds**  
  Saved maximum-likelihood estimates from the AMA1 and MSP1 model fits.

---

## Overview

The files in this repository illustrate how to:

1. simulate antibody concentration data from the latent sero-reactivity model,
2. fit full-likelihood latent-variable models to different antigens (AMA1 and MSP1),
3. recover age-dependent seroreactivity profiles,
4. generate diagnostic plots.

---

## How to run the analysis

Run the scripts in the following order:

```
source("00_sim_data.R")
source("01_ama1_analysis.R")
source("02_msp1_analysis.R")
```

---

## Citation

Please cite:

Giorgi, E. and Wallin, J.  
A flexible class of latent variable models for the analysis of antibody response data.
